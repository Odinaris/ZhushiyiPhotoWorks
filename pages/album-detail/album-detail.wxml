<view class="detail-container">
  <!-- Loading Overlay -->
  <view class="loading-overlay {{isLoading ? 'show' : ''}}" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">{{loadingText}}</text>
  </view>

  <!-- Header Section -->
  <view class="detail-header">
    <view class="header-content">
      <view class="header-left">
        <view class="album-title">{{album.title}}</view>
        <view class="album-meta">
          <text class="meta-item">{{album.categoryName}}</text>
          <text class="meta-divider">·</text>
          <text class="meta-item">{{album.images.length}} 张照片</text>
          <text class="meta-divider">·</text>
          <text class="meta-item">{{album.viewCount || 0}} 次浏览</text>
        </view>
        <view class="album-description" wx:if="{{album.description}}">{{album.description}}</view>
      </view>
      <!-- View Toggle -->
      <view class="view-toggle">
        <button class="view-mode-btn" bindtap="toggleViewMode">
          <text class="view-icon">{{viewMode === 'grid' ? '▦' : '☰'}}</text>
        </button>
      </view>
    </view>
  </view>

  <!-- Images Container -->
  <view class="images-container">
    <!-- Grid Mode - Two Column Waterfall -->
    <view class="images-grid grid" wx:if="{{viewMode === 'grid'}}">
      <!-- Left Column -->
      <view class="waterfall-column">
        <view 
          class="image-item"
          wx:for="{{processedImages.leftColumn}}"
          wx:key="index"
          bindtap="previewImage"
          data-index="{{item.index}}"
        >
          <view class="image-wrapper">
            <image 
              class="item-image" 
              src="{{item.url}}" 
              mode="widthFix" 
              lazy-load
            ></image>
          </view>
          <view class="image-caption" wx:if="{{item.description}}">{{item.description}}</view>
        </view>
      </view>
      
      <!-- Right Column -->
      <view class="waterfall-column">
        <view 
          class="image-item"
          wx:for="{{processedImages.rightColumn}}"
          wx:key="index"
          bindtap="previewImage"
          data-index="{{item.index}}"
        >
          <view class="image-wrapper">
            <image 
              class="item-image" 
              src="{{item.url}}" 
              mode="widthFix" 
              lazy-load
            ></image>
          </view>
          <view class="image-caption" wx:if="{{item.description}}">{{item.description}}</view>
        </view>
      </view>
    </view>
    
    <!-- List Mode -->
    <view class="images-grid list" wx:else>
      <view 
        class="image-item"
        wx:for="{{album.images}}"
        wx:key="index"
        bindtap="previewImage"
        data-index="{{index}}"
      >
        <view class="image-wrapper">
          <image 
            class="item-image" 
            src="{{item.url}}" 
            mode="widthFix" 
            lazy-load
          ></image>
        </view>
        <view class="image-caption" wx:if="{{item.description}}">{{item.description}}</view>
      </view>
    </view>
  </view>

  <!-- Share Section -->
  <view class="share-section">
    <button class="share-btn" open-type="share">
      <text class="share-icon">◈</text>
      <text>分享作品集</text>
    </button>
  </view>

  <!-- Loading State -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
  
  <!-- Error State -->
  <view class="error-container" wx:if="{{!loading && loadError}}">
    <view class="empty-icon">⚠</view>
    <text class="error-text">加载失败</text>
    <button class="btn-secondary" bindtap="onRetry">重试</button>
  </view>

  <!-- Empty State -->
  <view class="empty-container" wx:if="{{!loading && !album._id}}">
    <view class="empty-icon">□</view>
    <view class="empty-text">作品集不存在</view>
  </view>
</view>
